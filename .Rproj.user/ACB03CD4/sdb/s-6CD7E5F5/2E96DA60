{
    "collab_server" : "",
    "contents" : "### Reproduce column charts from Excel using plotly\nrequire(plotly)\n\n## Basic style\na.matrix <- rbind(c(0.2,0.3,0.3,0.5,0.3,0.6,0.4,0.8,0.2,0.5,0.1,0.3),c(0.3,0.5,0.1,0.3,0.1,0.2,0.1,0.4,0.1,0.2,0.1,0.4))\nrownames(a.matrix) <- c(\"Series1\",\"Series2\")\ncolnames(a.matrix) <- c(\"Jan\",\"Feb\",\"Mar\",\"Apr\",\"May\",\"Jun\",\"Jul\",\"Aug\",\"Sep\",\"Oct\",\"Nov\",\"Dec\")\n\nmyCols <- c(rgb(0,176,240, max=255), rgb(197,90,17, max=255))\nmyLineCols <- c(rgb(31,78,121, max=255), rgb(244, 177, 131, max=255))\n\np <- plot_ly()\n\np <- config(displayModeBar = FALSE)\n\np <- add_trace(p,\n               name = \"Series 1\",\n               type = \"bar\",\n\n               y = c(\"Jan\",\"Feb\",\"Mar\",\"Apr\",\"May\",\"Jun\",\"Jul\",\"Aug\",\"Sep\",\"Oct\",\"Nov\",\"Dec\"),\n               x = c(0.2,0.3,0.3,0.5,0.3,0.6,0.4,0.8,0.2,0.5,0.1,0.3),\n               marker = list(\n                   color = plotly::toRGB(myLineCols[1])\n               ),\n               orientation = \"h\")\n\np <- add_trace(p,\n               name = \"Series 2\",\n               type = \"bar\",\n               y = c(\"Jan\",\"Feb\",\"Mar\",\"Apr\",\"May\",\"Jun\",\"Jul\",\"Aug\",\"Sep\",\"Oct\",\"Nov\",\"Dec\"),\n               x = c(0.3,0.5,0.1,0.3,0.1,0.2,0.1,0.4,0.1,0.2,0.1,0.4),\n               marker = list(\n                   color = plotly::toRGB(myLineCols[2])\n               ),\n               orientation = \"h\")\n\np <-  layout(title = \"Column chart - BASIC STYLE\",\n             xaxis = list(\n                 linewidth = 1,\n                 linecolor = toRGB(rgb(141, 159, 183, max = 255), alpha = 1),\n                 ticks = \"none\",\n                 tickformat = \"%\",\n                 tickmode = \"array\",\n                 tickvals = c(0, .10, .20, .30, .40, .50, .60, .70, .80, .90, 1.00),\n                 ticktext = c(\"0%\",\"10%\",\"20%\",\"30%\",\"40%\",\"50%\",\"60%\",\"70%\",\"80%\",\"90%\",\"100%\"),\n                 range = list(0,1),\n                 showgrid = TRUE\n             ),\n             yaxis = list(\n                 showgrid = FALSE,\n                 linewidth = 1,\n                 linecolor = toRGB(rgb(225, 225, 225, max = 255), alpha = 1),\n                 tickcolor = toRGB(rgb(225, 225, 225, max = 255), alpha = 1),\n                 ticks = \"outside\"\n             ))\n\np\n\n\n## Junk chart\njunk.data <- as.matrix(rbind(c(-32, 58, 35, -12, 35, -16, 79),\n             c(64, -23, 10, -8, 43, 78, 30),\n             c(22, 64, 48, 10, -7, 22, 4)))\ncolnames(junk.data) <- c(\"29-Dec\",\"30-Dec\",\"31-Dec\",\"01-Jan\",\"02-Jan\",\"03-Jan\",\"04-Jan\")\nrownames(junk.data) <- c(\"Blue\", \"Yellow\", \"Red\")\n\n\nmyLineCols <- c(rgb(68, 112, 236, max=255), rgb(255, 192, 0, max=255), rgb(210, 0, 0, max=255))\n\n\np2 <- plot_ly()\n\np2 <- config(displayModeBar = FALSE)\n\np2 <- add_trace(p2,\n               name = \"Blue\",\n               type = \"bar\",\n               x = c(\"29-Dec\",\"30-Dec\",\"31-Dec\",\"01-Jan\",\"02-Jan\",\"03-Jan\",\"04-Jan\"),\n               y = c(-32, 58, 35, -12, 35, -16, 79),\n               marker = list(\n                   color = plotly::toRGB(myLineCols[1], 0),\n                   line = list(\n                       width = 3,\n                       color = plotly::toRGB(myLineCols[1], 1)\n                   )\n               ),\n               mode = \"lines+markers+text\",\n               orientation = \"v\")\n\np2 <- add_trace(p2,\n               name = \"Yellow\",\n               type = \"bar\",\n               x = c(\"29-Dec\",\"30-Dec\",\"31-Dec\",\"01-Jan\",\"02-Jan\",\"03-Jan\",\"04-Jan\"),\n               y = c(64, -23, 10, -8, 43, 78, 30),\n               marker = list(\n                   color = plotly::toRGB(myLineCols[2], 0),\n                   line = list(\n                       width = 3,\n                       color = plotly::toRGB(myLineCols[2], 1)\n                   )\n               ),\n               orientation = \"v\")\n\np2 <- add_trace(p2,\n               name = \"Red\",\n               type = \"bar\",\n               x = c(\"29-Dec\",\"30-Dec\",\"31-Dec\",\"01-Jan\",\"02-Jan\",\"03-Jan\",\"04-Jan\"),\n               y = c(22, 64, 48, 10, -7, 22, 4),\n               text = c(\"$22\", \"$64\", \"$48\", \"$10\", \"-$7\", \"$22\", \"$4\"),\n               marker = list(\n                   color = plotly::toRGB(myLineCols[3], 0),\n                   line = list(\n                       width = 3,\n                       color = plotly::toRGB(myLineCols[3], 1)\n                   )\n               ),\n               orientation = \"v\")\n\na <- list(              x = -.33,\n                        y = -32,\n                        text = \"-32\",\n                        showarrow = FALSE\n                        )\n\nb <- list(\n                        x = 6.33,\n                        y = -32,\n                        text = \"-32\",\n                        showarrow = FALSE\n)\n\nmy.annotations <- list()\nmy.annotations <- list(a, b)\n\n# (1 / ((7 * 3) - 2)) / 2\n\n\np2 <- layout(p2,\n            font = list(\n                color = plotly::toRGB(rgb(192, 0, 0, max = 255))\n            ),\n            title = \"<b>Sample Chart</b>\",\n            legend = list(\n                font = list(\n                    color = plotly::toRGB(rgb(192, 192, 192, max = 255)),\n                    size = 14\n                )\n            ),\n            plot_bgcolor = plotly::toRGB(rgb(64, 64, 64, max = 255)),\n            paper_bgcolor = plotly::toRGB(rgb(64, 64, 64, max = 255)),\n            bargap = 0,\n            bargroupgap = 0.15,\n            yaxis = list(\n                gridcolor = plotly::toRGB(rgb(104, 104, 104, max = 255)),\n                tickfont = list(\n                    color = plotly::toRGB(rgb(192, 192, 192, max = 255))\n                ),\n                range = list(-41, 81),\n                tickformat = \"$\"\n            ),\n            xaxis = list(\n                tickfont = list(\n                    color = plotly::toRGB(rgb(192, 192, 192, max = 255))\n                )\n            ),\n            annotations = my.annotations,\n            hovermode = \"closest\")\n\np2\n\n## NPS chart\nnps.data <- as.matrix(rbind(c(-4.35000, -4.30000, -4.25000, -4.20000, -4.15000, -4.10000, -4.05000, -4.00000, -3.95000, -3.90000, -3.85000, -3.80000, -3.75000, -3.70000),\n                            c(1.70000, 1.80000, 1.90000, 2.00000, 2.10000, 2.20000, 2.30000, 2.40000, 2.50000, 2.60000, 2.70000, 2.80000, 2.90000, 3.00000),\n                            c(3.17928, 2.71607, 2.18535, 1.60391, 0.98690, 0.34856, 0.29722, 0.93666, 1.55589, 2.14070, 2.67604, 3.14530, 3.52948, 3.80684)))\n\nnps.colors <- c(grDevices::rgb(0, 176, 80, 255, max = 255), # Brand A; green.\n                grDevices::rgb(192, 0, 0, 255, max = 255), # Brand B; red.\n                grDevices::rgb(46, 117, 182, 255, max = 255)) # Brand C; blue.\n\n\nrownames(nps.data) <- c(\"Brand A\", \"Brand B\", \"Brand C\")\n\np3 <- plot_ly()\n\np3 <- config(displayModeBar = FALSE)\n\nfor (i in 1:nrow(nps.data))\n{\n    p3 <- add_trace(p3,\n                    y = nps.data[i, ],\n                    x = c(\"Apr-15\",\"May-15\",\"Jun-15\",\"Jul-15\",\"Aug-15\",\"Sep-15\",\"Oct-15\",\"Nov-15\",\"Dec-15\",\"Jan-16\",\"Feb-16\",\"Mar-16\",\"Apr-16\",\"May-16\"),\n                    evaluate = TRUE,\n                    name = rownames(nps.data)[i],\n                    type = \"bar\",\n                    marker = list(\n                        color = plotly::toRGB(nps.colors[i])\n                    )\n    )\n}\n\np3 <- layout(p3,\n             title = \"<b>NPS</b>\",\n             bargap = 0.2,\n             hovermode = \"closest\",\n             xaxis = list(\n                 tickangle = 315,\n                 tickfont = list(\n                     size = 8\n                 )\n             ),\n             yaxis = list(\n                 autotick = FALSE,\n                 tick0 = -5,\n                 dtick = 1,\n                 range = list(-5, 5),\n                 showgrid = FALSE\n             )\n             )\n\np3\n\n\n## US Gun manufacture\n\nguns <- as.matrix(rbind(Pistols = c(0.26, 0.24, 0.25, 0.21, 0.22, 0.25, 0.24, 0.25, 0.28, 0.31, 0.32, 0.34, 0.41, 0.4),\n                        Revolvers = c(0.09, 0.08, 0.08, 0.11, 0.1, 0.09, 0.09, 0.08, 0.1, 0.1, 0.1, 0.1, 0.1, 0.09),\n                        Rifles = c(0.36, 0.38, 0.41, 0.43, 0.45, 0.43, 0.43, 0.44, 0.41, 0.41, 0.41, 0.4, 0.34, 0.35),\n                        Shotguns = c(0.28, 0.27, 0.23, 0.23, 0.22, 0.22, 0.24, 0.22, 0.2, 0.16, 0.15, 0.14, 0.14, 0.13),\n                        \"All others\" = c(0.01, 0.03, 0.03, 0.02, 0.01, 0.01, 0, 0.01, 0.01, 0.02, 0.02, 0.02, 0.01, 0.03)))\ncolnames(guns) <- c(1996, 1997, 1998, 1999, 2000, 2001, 2002, 2003, 2004, 2005, 2006, 2007, 2008, 2009)\n\ngun.colors <- c(grDevices::rgb(0, 112, 192, 255, max = 255), # blue.\n                grDevices::rgb(237, 125, 49, 255, max = 255), # orange\n                grDevices::rgb(102, 255, 255, 255, max = 255), # bright turquoise\n                grDevices::rgb(128, 128, 0, 255, max = 255), # green\n                grDevices::rgb(244, 177, 131, 255, max = 255)) # beige\n\ntext.colors <- c(grDevices::rgb(255, 255, 255, 255, max = 255),\n                grDevices::rgb(0, 0, 0, 255, max = 255),\n                grDevices::rgb(0, 0, 0, 255, max = 255),\n                grDevices::rgb(255, 255, 255, 255, max = 255),\n                grDevices::rgb(0, 0, 0, 255, max = 255))\n\np4 <- plot_ly()\n\np4 <- config(displayModeBar = FALSE)\n\nfor (i in 1:nrow(guns))\n{\n    p4 <- add_trace(p4,\n                    y = guns[i, ],\n                    x = colnames(guns),\n                    evaluate = TRUE,\n                    name = rownames(guns)[i],\n                    type = \"bar\",\n                    marker = list(\n                        color = plotly::toRGB(gun.colors[i], 1)\n                    ),\n                    legendgroup = \"group\"\n    )\n}\n\nfor (i in 1:nrow(guns))\n{\n\n    if (i == 1)\n    {\n        gunsum <- guns[i, ]\n        textpos <- gunsum / 2\n    }\n    else\n    {\n        textpos <- gunsum + (guns[i, ] / 2)\n        gunsum <- gunsum + guns[i, ]\n    }\n\n    p4 <- add_trace(p4,\n                    y = textpos,\n                    x = colnames(guns),\n                    evaluate = TRUE,\n                    name = rownames(guns)[i],\n                    type = \"scatter\",\n                    mode = \"text\",\n                    text = paste(guns[i, ] * 100,\"%\", sep = \"\"),\n                    textfont = list(\n                        size = 8,\n                        color = plotly::toRGB(text.colors[i], 1)\n                    ),\n                    showlegend = FALSE,\n                    hoverinfo = \"none\",\n                    legendgroup = \"group\"\n    )\n}\n\np4 <- add_trace(p4,\n                type = \"line\",\n                name = \"Millions of units\",\n                y = c(3.75, 4, 3.8, 3, 3.5, 3.4, 3.3, 3.4, 3.75, 4, 4.3, 5.5, 5.4, 6.5),\n                x = c(1996, 1997, 1998, 1999, 2000, 2001, 2002, 2003, 2004, 2005, 2006, 2007, 2008, 2009),\n                line = list(\n                    color = plotly::toRGB(rgb(128, 0, 128, 255, max = 255)),\n                    width = 2\n                ),\n                # text = c(\"3.75\", \"4\", \"3.8\", \"3\", \"3.5\", \"3.4\", \"3.3\", \"3.4\", \"3.75\", \"4\", \"4.3\", \"5.5\", \"5.4\", \"6.5\"),\n                yaxis = \"y2\",\n                mode = \"lines+markers\")\n\np4 <- layout(p4,\n        title = \"U.S. Gun manufacture by type\",\n        barmode = \"stack\",\n        yaxis = list(\n            tickformat = \"%\",\n            range = list(0, 1.01),\n            autotick = FALSE,\n            tick0 = 0,\n            dtick = 0.1\n        ),\n        yaxis2 = list(\n            overlaying='y',\n            side='right',\n            range = list(2.5, 7.5),\n            tickformat = \".1f\",\n            autotick = FALSE,\n            tick0 = -2.5,\n            dtick = 0.5,\n            title = \"Millions of units\"\n        ),\n        margin = list(\n            r = 200\n        ),\n        xaxis = list(\n            tick0 = 1995,\n            dtick = 1\n        ),\n        legend = list(\n            x = 1.15,\n            y = 1\n        )\n)\n\np4\n\n## Hot Dogs\n\nhotdogs <- as.matrix(rbind(\"1st\" = c(25, 50, 50.5, 44.5, 53.5, 49, 54, 66, 59, 68, 54),\n           \"2nd\" = c(24, 31, 26, 30.5, 38, 37, 52, 63, 59, 64.5, 43),\n           \"3rd\" = c(22, 23.5, 25.5, 29.5, 32, 32, 37, 49, 42, 55, 37)))\ncolnames(hotdogs) <- c(\"`00\", \"`01\", \"`02\", \"`03\", \"`04\", \"`05\", \"`06\", \"`07\", \"`08\", \"`09\", \"`10\")\n\nhotcols <- c(grDevices::rgb(7, 135, 65, 255, max = 255),\n                grDevices::rgb(56, 184, 72, 255, max = 255),\n                grDevices::rgb(162, 213, 101, 255, max = 255))\n\np5 <- plot_ly()\n\np5 <- config(displayModeBar = FALSE)\n\nfor (i in 1:nrow(hotdogs))\n{\n    p5 <- add_trace(p5,\n                    y = hotdogs[i, ],\n                    x = paste(\" \",colnames(hotdogs), sep = \"\"),\n                    evaluate = TRUE,\n                    name = rownames(hotdogs)[i],\n                    type = \"bar\",\n                    marker = list(\n                        color = plotly::toRGB(hotcols[i], 1)\n                    )\n    )\n}\n\np5 <- layout(\n        barmode = \"stack\",\n        title = \"TOP THREE HOT DOG EATERS\",\n        titlefont = list(\n            family = \"Times New Roman\"\n        ),\n        yaxis = list(\n            range = list(0, 200),\n            tick0 = 0,\n            dtick = 50,\n            title = \"Hot dogs and buns\",\n            showgrid = FALSE,\n            zeroline = TRUE,\n            zerolinecolor = plotly::toRGB(rgb(225, 225, 225, 255, max = 255), 1),\n            tickfont = list(\n                family = \"Times New Roman\"\n            )\n        ),\n        xaxis = list(\n            tick0 = 0,\n            dtick = 1,\n            tickfont = list(\n                family = \"Times New Roman\"\n            )\n        )\n)\n\np5\n",
    "created" : 1464045612520.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "254359032",
    "id" : "2E96DA60",
    "lastKnownWriteTime" : 1464046788,
    "last_content_update" : 1464046788206,
    "path" : "C:/R/columnChart_experiment.R",
    "project_path" : null,
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 6,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}