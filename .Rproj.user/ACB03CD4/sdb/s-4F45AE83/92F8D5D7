{
    "collab_server" : "",
    "contents" : "### Reproduce line charts from Excel using plotly\nrequire(plotly)\n\n## Basic style\na.matrix <- rbind(c(0.2,0.3,0.3,0.5,0.3,0.6,0.4,0.8,0.2,0.5,0.1,0.3),c(0.3,0.5,0.1,0.3,0.1,0.2,0.1,0.4,0.1,0.2,0.1,0.4))\nrownames(a.matrix) <- c(\"Series1\",\"Series2\")\ncolnames(a.matrix) <- c(\"Jan\",\"Feb\",\"Mar\",\"Apr\",\"May\",\"Jun\",\"Jul\",\"Aug\",\"Sep\",\"Oct\",\"Nov\",\"Dec\")\n\nmyCols <- c(rgb(0,176,240, max=255), rgb(197,90,17, max=255))\nmyLineCols <- c(rgb(31,78,121, max=255),rgb(192,0,0, max=255))\n\np <- plot_ly()\n\np <- config(displayModeBar = FALSE)\n\np <- add_trace(p,\n               name = \"Series 1\",\n               type = \"line\",\n               x = c(\"Jan\",\"Feb\",\"Mar\",\"Apr\",\"May\",\"Jun\",\"Jul\",\"Aug\",\"Sep\",\"Oct\",\"Nov\",\"Dec\"),\n               y = c(0.2,0.3,0.3,0.5,0.3,0.6,0.4,0.8,0.2,0.5,0.1,0.3),\n               line = list(\n                   color = myLineCols[1],\n                   width = 3\n               ),\n               mode = \"lines\")\n\np <- add_trace(p,\n               name = \"Series 2\",\n               type = \"line\",\n               x = c(\"Jan\",\"Feb\",\"Mar\",\"Apr\",\"May\",\"Jun\",\"Jul\",\"Aug\",\"Sep\",\"Oct\",\"Nov\",\"Dec\"),\n               y = c(0.3,0.5,0.1,0.3,0.1,0.2,0.1,0.4,0.1,0.2,0.1,0.4),\n               line = list(\n                   color = myLineCols[2],\n                   width = 3\n               ),\n               mode = \"lines\")\n\np <-  layout(title = \"Line chart - BASIC STYLE\",\n             yaxis = list(\n                 linewidth = 1,\n                 linecolor = toRGB(rgb(141, 159, 183, max = 255), alpha = 1),\n                 ticks = \"none\",\n                 tickformat = \"%\",\n                 tickmode = \"array\",\n                 tickvals = c(0, .10, .20, .30, .40, .50, .60, .70, .80, .90, 1.00),\n                 ticktext = c(\"0%\",\"10%\",\"20%\",\"30%\",\"40%\",\"50%\",\"60%\",\"70%\",\"80%\",\"90%\",\"100%\"),\n                 range = list(0,1),\n                 showgrid = TRUE\n             ),\n             xaxis = list(\n                 showgrid = FALSE,\n                 linewidth = 1,\n                 linecolor = toRGB(rgb(141, 159, 183, max = 255), alpha = 1),\n                 ticks = \"outside\"\n             ))\n\np\n\n\n## Junk chart\n\njunk.data <- read.csv(\"C:\\\\R\\\\junk.csv\", header = TRUE)\njunk.data.text <- as.matrix((junk.data[, -1, drop = FALSE]))\nrownames(junk.data) <- junk.data[, 1]\njunk.data <- as.matrix(junk.data[, -1])\njunk.colors <- c(grDevices::rgb(219, 99, 24, 255, max = 255), # Apples, orange-ish.\n                 grDevices::rgb(13, 168, 170, 255, max = 255), # Bananas, teal.\n                 grDevices::rgb(110, 18, 90, 255, max = 255), # Lemons, dark purple\n                 grDevices::rgb(21, 113, 189, 255, max = 255), # Limes, blue\n                 grDevices::rgb(97, 111, 2, 255, max = 255), # Oranges, dark green\n                 grDevices::rgb(8, 68, 111, 255, max = 255), # Pears, dark blue\n                 grDevices::rgb(175, 21, 1, 255, max = 255), # Strawberries, dark red\n                 grDevices::rgb(158, 72, 14, 255, max = 255), # Gooseberries\n                 grDevices::rgb(99, 99, 99, 255, max = 255), # Cloudberries\n                 grDevices::rgb(153, 115, 0, 255, max = 255), # Kiwi fruit\n                 grDevices::rgb(38, 68, 120, 255, max = 255), # Raspberries\n                 grDevices::rgb(67, 104, 43, 255, max = 255), # Blackberries\n                 grDevices::rgb(124, 175, 221, 255, max = 255), # Currants\n                 grDevices::rgb(241, 151, 90, 255, max = 255), # Rhubarb\n                 grDevices::rgb(183, 183, 183, 255, max = 255), # Peach\n                 grDevices::rgb(255, 205, 51, 255, max = 255), # Mango\n                 grDevices::rgb(105, 142, 208, 255, max = 255), # Papaya\n                 grDevices::rgb(140, 193, 104, 255, max = 255), # Goat\n                 grDevices::rgb(50, 125, 194, 255, max = 255), # Blueberries\n                 grDevices::rgb(210, 96, 18, 255, max = 255)) # Lingonberries\n\np2 <- plot_ly()\n\np2 <- config(displayModeBar = FALSE)\n\nfor (i in 1:nrow(junk.data))\n{\n    p2 <- add_trace(p2,\n                    y = junk.data[i, ],\n                    x = colnames(junk.data),\n                    text = as.character(as.vector(junk.data.text[i, ])),\n                    hoverinfo = \"y+name\",\n                    textposition = \"top middle\",\n                    textfont = list(\n                                    color = toRGB(rgb(150, 150, 150, max = 200), alpha = 1)\n                    ),\n                    evaluate = TRUE,\n                    name = rownames(junk.data)[i],\n                    mode = \"markers+lines+text\",\n                    line = list(\n                        color = toRGB(junk.colors[i]),\n                        width = 3\n                    ),\n                    marker = list(\n                        size = 10,\n                        color = toRGB(junk.colors[i]),\n                        line = list(\n                            color = \"black\",\n                            width = 1\n                        )\n                    )\n         )\n}\n\np2 <- layout(\n    title = \"Monthly Sales\",\n    paper_bgcolor = toRGB(rgb(222, 233, 254, max = 255), alpha = 1),\n    plot_bgcolor = toRGB(rgb(222, 233, 254, max = 255), alpha = 1),\n    yaxis = list(\n        title = \"\",\n        showgrid = FALSE,\n        ticks = \"none\",\n        tickmode = \"array\",\n        tickvals = c(0, 5, 10, 15, 20, 25, 30, 35, 40, 45),\n        ticktext = c(\"0\",\"5\",\"10\",\"15\",\"20\",\"25\",\"30\",\"35\",\"40\",\"45\"),\n        range = list(0,45),\n        tickfont = list(\n            size = 10\n        ),\n        zeroline = FALSE\n    ),\n    xaxis = list(\n        title = \"\",\n        showgrid = FALSE,\n        ticks = \"none\",\n        tickfont = list(\n            size = 10\n        )\n    ),\n    margin = list(\n        b = 80,\n        r = 80\n    )\n)\n\np2\n\n\n## NPS chart\nnps.data <- as.matrix(rbind(c(-4.35000, -4.30000, -4.25000, -4.20000, -4.15000, -4.10000, -4.05000, -4.00000, -3.95000, -3.90000, -3.85000, -3.80000, -3.75000, -3.70000),\n              c(1.70000, 1.80000, 1.90000, 2.00000, 2.10000, 2.20000, 2.30000, 2.40000, 2.50000, 2.60000, 2.70000, 2.80000, 2.90000, 3.00000),\n              c(3.17928, 2.71607, 2.18535, 1.60391, 0.98690, 0.34856, 0.29722, 0.93666, 1.55589, 2.14070, 2.67604, 3.14530, 3.52948, 3.80684)))\n\nnps.colors <- c(grDevices::rgb(46, 117, 182, 255, max = 255), # Brand A; blue.\n                 grDevices::rgb(192, 0, 0, 255, max = 255), # Brand B; red.\n                 grDevices::rgb(0, 176, 80, 255, max = 255)) # Brand C; green.\n\nrownames(nps.data) <- c(\"Brand A\", \"Brand B\", \"Brand C\")\n\np3 <- plot_ly()\n\nfor (i in 1:nrow(nps.data))\n{\n    p3 <- add_trace(p3,\n                    y = nps.data[i, ],\n                    x = c(\"Apr-15\",\"May-15\",\"Jun-15\",\"Jul-15\",\"Aug-15\",\"Sep-15\",\"Oct-15\",\"Nov-15\",\"Dec-15\",\"Jan-16\",\"Feb-16\",\"Mar-16\",\"Apr-16\",\"May-16\"),\n                    evaluate = TRUE,\n                    name = rownames(nps.data)[i],\n                    mode = \"lines\",\n                    line = list(\n                        color = toRGB(nps.colors[i]),\n                        width = 3\n                    )\n    )\n}\n\np3 <- layout(\n    title = \"NPS\",\n    yaxis = list(\n        title = \"\",\n        showgrid = FALSE,\n        ticks = \"none\",\n        tickmode = \"array\",\n        tickvals = c(-5, -4, -3, -2, -1, 0, 1, 2, 3, 4, 5),\n        ticktext = c(\"-5\", \"-4\", \"-3\", \"-2\", \"-1\", \"0\", \"1\", \"2\", \"3\", \"4\", \"5\"),\n        range = list(-5,5),\n        tickfont = list(\n            size = 10\n        ),\n        zeroline = TRUE,\n        zerolinecolor = toRGB(rgb(225, 225, 225, max = 255), alpha = 1)\n    ),\n    xaxis = list(\n        title = \"\",\n        showgrid = FALSE,\n        ticks = \"none\",\n        tickfont = list(\n            size = 10\n        ),\n        tickangle = -45,\n        zeroline = FALSE\n    ),\n    margin = list(\n        b = 80,\n        r = 80\n    )\n)\n\np3\n\n\n### Aging population lines\n\nage.data <- as.matrix(rbind(c(0.154, 0.143, 0.138, 0.122, 0.121, 0.116, 0.109, 0.093, 0.08, 0.107, 0.113, 0.084, 0.072, 0.076, 0.068, 0.068),\n                c(0.358, 0.354, 0.343, 0.339, 0.323, 0.304, 0.298, 0.295, 0.264, 0.232, 0.271, 0.295, 0.248, 0.213, 0.218, 0.207),\n                c(0.357, 0.354, 0.359, 0.369, 0.377, 0.39, 0.384, 0.383, 0.389, 0.376, 0.322, 0.317, 0.371, 0.401, 0.37, 0.354),\n                c(0.104, 0.119, 0.126, 0.131, 0.137, 0.146, 0.161, 0.174, 0.198, 0.203, 0.201, 0.206, 0.196, 0.186, 0.22, 0.246),\n                c(0.027, 0.03, 0.034, 0.039, 0.041, 0.043, 0.047, 0.054, 0.068, 0.081, 0.092, 0.098, 0.113, 0.125, 0.124, 0.124)))\nx.labels <- c(\"1860\", \"1870\", \"1880\", \"1890\", \"1900\", \"1910\", \"1920\", \"1930\", \"1940\", \"1950\", \"1960\", \"1970\", \"1980\", \"1990\", \"2000\", \"2005\")\nrownames(age.data) <- c(\"Under 5\",\"5 to 19\",\"20 to 44\",\"45 to 64\",\"65+\")\n\nsetColors <- function (x, red, green, blue) {\n    col.vector <- \"\"\n    number.rows <- nrow(x) + 1\n\n    for (i in nrow(x):1){\n        red.factor <- ((255 - red) / number.rows) * i\n        green.factor <- ((255 - green) / number.rows) * i\n        blue.factor <- ((255 - blue) / number.rows) * i\n\n        col.vector <- c(col.vector, grDevices::rgb(red + red.factor, green + green.factor, blue + blue.factor, 255, max = 255))\n    }\n\n    return(col.vector[-1, drop = FALSE])\n}\n\nage.colors <- setColors(age.data, 38, 85, 154)\n\np4 <- plot_ly()\n\nfor (i in 1:nrow(age.data))\n{\n    p4 <- add_trace(p4,\n                    y = age.data[i, ],\n                    x = c(\"1860\", \"1870\", \"1880\", \"1890\", \"1900\", \"1910\", \"1920\", \"1930\", \"1940\", \"1950\", \"1960\", \"1970\", \"1980\", \"1990\", \"2000\", \"2005\"),\n                    evaluate = TRUE,\n                    name = rownames(age.data)[i],\n                    mode = \"lines\",\n                    line = list(\n                        color = toRGB(age.colors[i], alpha = 1),\n                        width = 3\n                    )\n    )\n}\n\na <- list()\n\nb <- list(\n    y = 1.15,\n    x = 0.5,\n    text = c(\"In 1860, an estimated 13.1 percent of the U.S. population was 45 years or older.<br>In 2005, the estimate is up to 23.9 percent.\"),\n    xref = \"paper\",\n    yref = \"paper\",\n    showarrow = FALSE,\n    # borderwidth = 1,\n    # bordercolor = toRGB(rgb(255,255,255, max = 255), alpha = 1),\n    # bgcolor = toRGB(rgb(245,56,177, max=255), alpha = 1),\n    font = list(\n        color = toRGB(rgb(0,0,0, max=255), alpha = 1),\n        size = 10\n    )\n)\n\n\n\n\n\na <- list(b)\n\np4 <- layout(title = \"AN AGING POPULATION\",\n             yaxis = list(\n                        ticks = \"none\",\n                        tickmode = \"array\",\n                        tickvals = c(0, .1, .2, .3, .4),\n                        ticktext = c(\"0%\", \"10%\", \"20%\", \"30%\", \"40%\"),\n                        range = list(0, .42),\n                        tickformat = \"%\",\n                        zeroline = FALSE\n                     ),\n             annotations = a,\n             xaxis = list(\n                        showgrid = FALSE,\n                        linewidth = 1,\n                        linecolor = toRGB(rgb(225, 225, 225, max = 255)),\n                        tickmode = \"array\",\n                        tickvals = c(1860, 1870, 1880, 1890, 1900, 1910, 1920, 1930, 1940, 1950, 1960, 1970, 1980, 1990, 2000, 2005),\n                        ticktext = c(\"1860\", \"1870\", \"1880\", \"1890\", \"1900\", \"1910\", \"1920\", \"1930\", \"1940\", \"1950\", \"1960\", \"1970\", \"1980\", \"1990\", \"2000\", \"2005\"),\n                        tickfont = list(\n                            size = 8\n                        ),\n                        tickangle = 0\n                     ),\n             margin = list(\n                 t = 100\n             )\n             )\n\np4\n\n\n### Tufte\np5 <- plot_ly()\n\np5 <- add_trace(y = c(8, 7, 5.7, 7, 7, 7.5, 7.5, 8, 9, 8.5, 12, 13, 14, 14.5, 15, 15.5, 20, 22, 30, 37, 39, 41.9),\n                x = c(1987, 1988, 1989, 1990, 1991, 1992, 1993, 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002, 2003, 2004, 2005, 2006, 2007, 2008),\n                line = list(\n                    width = 7,\n                    color = \"black\"\n                )\n\n                )\n\np5 <- layout(showlegend = TRUE,\n             yaxis = list(\n                            tickmode = \"array\",\n                            tickvals = c(5.7, 10, 15, 20, 25, 30, 35, 41.9),\n                            ticktext = c(\"5.7\", \"10\", \"15\", \"20\", \"25\", \"30\", \"35\", \"41.9\"),\n                            range = list(0, 42),\n                            linewidth = 1,\n                            linecolor = \"black\",\n                            ticks = \"outside\",\n                            showgrid = FALSE\n                            ),\n             xaxis = list(\n                            tickmode = \"array\",\n                            tickvals = c(1987, 1990, 1993, 1996, 1999, 2002, 2005, 2008),\n                            ticktext = c(\"1987\", \"1990\", \"1993\", \"1996\", \"1999\", \"2002\", \"2005\", \"2008\"),\n                            showgrid = FALSE,\n                            linewidht = 1,\n                            linecolor = \"black\",\n                            ticks = \"outside\"\n             ),\n             margin = list(\n                 pad = 10\n             )\n)\np5\n",
    "created" : 1463543302341.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2614743953",
    "id" : "92F8D5D7",
    "lastKnownWriteTime" : 1463358193,
    "last_content_update" : 1463358193,
    "path" : "C:/R/lineChart_experiment.R",
    "project_path" : null,
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 9,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}